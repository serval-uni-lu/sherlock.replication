# Change Metric Collection & Final Model Learning Data Preparation 

Compute change metrics and combine them with static (flakiness & size) and sbfl metrics. 
The final output is stored as `../model-generation/data/${project}.csv`.

### Output file

The final output file (`results/${project}.csv`) contains static, change, and sbfl score metrics defined below 
for every class covered at least once by any test

- static metrics: see `static-metrics/spoon/README.md`
- change metrics (file granularity):
    - age: the time interval to the last changes made on the file that contains a target class
    - unique changes (uniq_changes): the number of prior changes made on the file that contains a target class
    - developers: the number of distinct developers that participated in the change history of the file that contains a target class

- sbfl: suspiciousness scores of each class computed by dstar, ochiai, tarantula, and barinel


### Preparaion 

Under `benchmarks`, cloen the github repositories of all five projects.
(e.g., for pulsar, its github repository should be cloned under `benchmarks` as `pulsar`)

### Usage 

`./run.sh ${projec} ${repo} ${renamed} ${chginfo} ${dest}` 

#### Arguments
- `${project}`: a project name. This value will be used to identify a result file 
- `${repo}`: a git repository of a project that we target to collect commit change information. 
- `${renamed}`: the commit change information file generated by `commit_changes/run.sh`: e.g., `commit_changes/results/${project}.commit_chgs.pf.pkl`
- `${chginfo}`: the file renaming information file generated by `commit_changes/run.sh`: e.g., `commit_changes/results/${project}.rename_history.json`
- `${dest}`: a directory where the output file of `run.sh` will be stored

Running the command above will generate

- `targets/test_and_class_info_${project}.pkl`
- `${dest}/${project}/${commit}/ccm_metrics.pf.csv`
- `${dest}/${project}/sbfl_chgs_${project}.csv`
- `../model-generation/data/${project}.csv`

Among these files, `../model-generation/data/${project}.csv` contains a complete set of metrics (i.e., static (flakiness & size), sbfl, change) 
and will be used for model learning.

Currently, all these files are already stored under `results` and `targets`.

